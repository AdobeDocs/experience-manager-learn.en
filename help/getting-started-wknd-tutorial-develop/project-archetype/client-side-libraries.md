---
title: Client libraries and front-end workflow
description: Learn how to use Client libraries to deploy and manage CSS and JavaScript for an Adobe Experience Manager (AEM) Sites implementation. Learn how the ui.frontend module, a webpack project, can be integrated into the end-to-end build process.
version: 6.4, 6.5, Cloud Service
feature: Core Components, AEM Project Archetype
topic: Content Management, Development
role: Developer
level: Beginner
jira: KT-4083
thumbnail: 30359.jpg
doc-type: Tutorial
exl-id: 8d3026e9-a7e2-4a76-8a16-a8197a5e04e3
recommendations: noDisplay, noCatalog
duration: 680
---
# Client libraries and front-end workflow {#client-side-libraries}

Learn how Client-Side Libraries or clientlibs are used to deploy and manage CSS and JavaScript for an Adobe Experience Manager (AEM) Sites implementation. This tutorial also covers how the [ui.frontend](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/developing/archetype/uifrontend.html) module, a de-coupled [webpack](https://webpack.js.org/) project, can be integrated into the end-to-end build process.

## Prerequisites {#prerequisites}

Review the required tooling and instructions for setting up a [local development environment](overview.md#local-dev-environment).

It is also recommended to review the [Component Basics](component-basics.md#client-side-libraries) tutorial to understand the fundamentals of client-side libraries and AEM.

### Starter Project

>[!NOTE]
>
> If you successfully completed the previous chapter, you can reuse the project and skip the steps for checking out the starter project.

Check out the base-line code that the tutorial builds on:

1. Check out the `tutorial/client-side-libraries-start` branch from [GitHub](https://github.com/adobe/aem-guides-wknd)

    ```shell
    $ cd aem-guides-wknd
    $ git checkout tutorial/client-side-libraries-start
    ```

1. Deploy code base to a local AEM instance using your Maven skills:

    ```shell
    $ mvn clean install -PautoInstallSinglePackage
    ```

    >[!NOTE]
    >
    > If using AEM 6.5 or 6.4, append the `classic` profile to any Maven commands.

    ```shell
    $ mvn clean install -PautoInstallSinglePackage -Pclassic
    ```

You can always view the finished code on [GitHub](https://github.com/adobe/aem-guides-wknd/tree/tutorial/client-side-libraries-solution) or check out the code locally by switching to the branch `tutorial/client-side-libraries-solution`.

## Objectives

1. Understand how client-side libraries are included onto a page via an editable template.
1. Learn how to use the `ui.frontend` module and a webpack development server for dedicated front-end development.
1. Understand the end-to-end workflow of delivering compiled CSS and JavaScript to a Sites implementation.

## What you are going to build {#what-build}

In this chapter, you add some baseline styles for the WKND site and the Article Page Template to bring the implementation closer to the [UI design mockups](assets/pages-templates/wknd-article-design.xd). You use an advanced front-end workflow to integrate a webpack project into an AEM client library.

![Finished Styles](assets/client-side-libraries/finished-styles.png)

*Article Page with baseline styles applied*

## Background {#background}

Client-Side Libraries provide a mechanism to organize and manage CSS and JavaScript files necessary for an AEM Sites implementation. The basic goals for client-side libraries or clientlibs are:

1. Store CSS/JS in small discrete files for easier development and maintenance
1. Manage dependencies on third-party frameworks in an organized fashion
1. Minimize the number of client-side requests by concatenating CSS/JS into one or two requests.

More information about using [Client-Side Libraries can be found here.](https://experienceleague.adobe.com/docs/experience-manager-65/developing/introduction/clientlibs.html)

Client-side libraries do have some limitations. Most notably is a limited support for popular front-end languages like Sass, LESS, and TypeScript. In the tutorial, let's look at how the **ui.frontend** module can help solve this.

Deploy the starter code base to a local AEM instance and navigate to [http://localhost:4502/editor.html/content/wknd/us/en/magazine/guide-la-skateparks.html](http://localhost:4502/editor.html/content/wknd/us/en/magazine/guide-la-skateparks.html). This page is unstyled. Let's implement Client-side libraries for the WKND brand to add CSS and JavaScript to the page.

## Client-Side Libraries Organization {#organization}

Next let's explore the organization of clientlibs generated by the [AEM Project Archetype](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/developing/archetype/overview.html).

![High level clientlibrary organization](./assets/client-side-libraries/high-level-clientlib-organization.png)

*High-level diagram Client-side Library organization and page inclusion*

>[!NOTE]
>
> The following client-side library organization is generated by AEM Project Archetype but represents merely a starting point. How a project ultimately manages and delivers CSS and JavaScript to a Sites implementation can vary dramatically based on resources, skill sets and requirements.

1. Using VSCode or other IDE open up the **ui.apps** module.
1. Expand the path `/apps/wknd/clientlibs` to view the clientlibs generated by the archetype.

    ![Clientlibs in ui.apps](assets/client-side-libraries/four-clientlib-folders.png)

    In the below section, these clientlibs are reviewed in greater details.

1. The following table summarizes the client libraries. More details about [including Client Libraries can be found here](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/developing/including-clientlibs.html?lang=en#developing).

    | Name | Description | Notes |
    |-------------------| ------------| ------|
    | `clientlib-base`  | Base level of CSS and JavaScript needed for WKND Site to function | embeds Core Component client libs |
    | `clientlib-grid`  | Generates the CSS necessary for [Layout Mode](https://experienceleague.adobe.com/docs/experience-manager-65/authoring/siteandpage/responsive-layout.html) to work. | Mobile/Tablet breakpoints can be configured here |
    | `clientlib-site` | Contains site-specific theme for the WKND Site | Generated by the `ui.frontend` module |
    | `clientlib-dependencies` | Embeds any third-party dependencies | Generated by the `ui.frontend` module |

1. Observe that `clientlib-site` and `clientlib-dependencies` are ignored from source control. This is by design, since these are generated at build time by the `ui.frontend` module.

## Update base styles {#base-styles}

Next, update the base styles defined in the **[ui.frontend](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/developing/archetype/uifrontend.html)** module. The files in the `ui.frontend` module generate the `clientlib-site` and `clientlib-dependecies` libraries that contain the Site theme and any third-party dependencies.

Client-side libraries do not support more advanced languages like [Sass](https://sass-lang.com/) or [TypeScript](https://www.typescriptlang.org/). There are several open-source tools like [NPM](https://www.npmjs.com/) and [webpack](https://webpack.js.org/) that accelerate and optimize front-end development. The goal of the **ui.frontend** module is to be able to use these tools to manage most front-end source files.

1. Open up the **ui.frontend** module and navigate to `src/main/webpack/site`.
1. Open the file `main.scss`

    ![main.scss - entrypoint](assets/client-side-libraries/main-scss.png)

    `main.scss` is the entry point to the Sass files in the `ui.frontend` module. It includes the `_variables.scss` file, which contains a series of brand variables to be used throughout different Sass files in the project. The `_base.scss` file is also included and defines some basic styles for HTML elements. A regular expression includes the styles for individual components styles under `src/main/webpack/components`. Another regular expression includes the files under `src/main/webpack/site/styles`.

1. Inspect the file `main.ts`. It includes `main.scss` and a regular expression to collect any `.js` or `.ts` files in the project. This entry point is used by the [webpack configuration files](https://webpack.js.org/configuration/) as the entry point for the entire `ui.frontend` module.

1. Inspect the files beneath `src/main/webpack/site/styles`:

    ![Style Files](assets/client-side-libraries/style-files.png)

    These files styles for global elements in the template, like the Header, Footer and main content container. The CSS rules in these files target different HTML elements `header`, `main`, and  `footer`. These HTML elements were defined by policies in the previous chapter [Pages and Templates](./pages-templates.md).

1. Expand the `components` folder under `src/main/webpack` and inspect the files.

    ![Component Sass files](assets/client-side-libraries/component-sass-files.png)

    Each file maps to a Core Component like the [Accordion Component](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/wcm-components/accordion.html?lang=en). Each Core Component is built with [Block Element Modifier](https://getbem.com/) or BEM notation to make it easier to target specific CSS classes with style rules. The files beneath `/components` have been stubbed out by the AEM Project Archetype with the different BEM rules for each component.

1. Download the WKND Base Styles **[wknd-base-styles-src-v3.zip](/help/getting-started-wknd-tutorial-develop/project-archetype/assets/client-side-libraries/wknd-base-styles-src-v3.zip)** and **unzip** the file.

    ![WKND Base Styles](assets/client-side-libraries/wknd-base-styles-unzipped.png)

    To accelerate the tutorial, several Sass files that implement the WKND brand based on Core Components and the structure of the Article Page Template is provided.

1. Overwrite the contents of `ui.frontend/src` with files from the previous step. The contents of the zip should overwrite the following folders:

    ```plain
    /src/main/webpack
             /components
             /resources
             /site
             /static
    ```

    ![Changed files](assets/client-side-libraries/changed-files-uifrontend.png)

    Inspect the changed files to see details of the WKND style implementation.

## Inspect the ui.frontend integration {#ui-frontend-integration}

A key integration piece built into the **ui.frontend** module, [aem-clientlib-generator](https://github.com/wcm-io-frontend/aem-clientlib-generator) takes the compiled CSS and JS artifacts from a webpack/npm project and transforms them into AEM client-side libraries.

![ui.frontend architecture integration](assets/client-side-libraries/ui-frontend-architecture.png)

The AEM Project Archetype automatically sets up this integration. Next, explore how it works.


1. Open a command-line terminal and install the **ui.frontend** module using the `npm install` command:

    ```shell
    $ cd ~/code/aem-guides-wknd/ui.frontend
    $ npm install
    ```

    >[!NOTE]
    >
    >`npm install` run is needed only once, like after a new clone or generation of the project.

1. Start the webpack dev server in **watch** mode by running the following command:

    ```shell
    $ npm run watch
    ```

1. This compiles the source files from the `ui.frontend` module and syncs the changes with AEM at [http://localhost:4502](http://localhost:4502)

    ```shell
    + jcr_root/apps/wknd/clientlibs/clientlib-site/js/site.js
    + jcr_root/apps/wknd/clientlibs/clientlib-site/js
    + jcr_root/apps/wknd/clientlibs/clientlib-site
    + jcr_root/apps/wknd/clientlibs/clientlib-dependencies/css.txt
    + jcr_root/apps/wknd/clientlibs/clientlib-dependencies/js.txt
    + jcr_root/apps/wknd/clientlibs/clientlib-dependencies
    http://admin:admin@localhost:4502 > OK
    + jcr_root/apps/wknd/clientlibs/clientlib-site/css
    + jcr_root/apps/wknd/clientlibs/clientlib-site/js/site.js
    http://admin:admin@localhost:4502 > OK
    ```

1. The command `npm run watch` ultimately populates the **clientlib-site** and **clientlib-dependencies** in the **ui.apps** module which is then synced automatically with AEM.

    >[!NOTE]
    >
    >There is also a `npm run prod` profile which minifies the JS and CSS. This is the standard compilation whenever the webpack build is triggered via Maven. More details about the [ui.frontend module can be found here](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/developing/archetype/uifrontend.html).

1. Inspect the file `site.css` beneath `ui.frontend/dist/clientlib-site/site.css`. This is the compiled CSS based on the Sass source files.

    ![Distributed Site css](assets/client-side-libraries/ui-frontend-dist-site-css.png)

1. Inspect the file `ui.frontend/clientlib.config.js`. This is the configuration file for an npm plugin, [aem-clientlib-generator](https://github.com/wcm-io-frontend/aem-clientlib-generator) that transforms the contents of `/dist` into a client library and moves it to the `ui.apps` module.

1. Inspect the file `site.css` in the **ui.apps** module at `ui.apps/src/main/content/jcr_root/apps/wknd/clientlibs/clientlib-site/css/site.css`. This should be an identical copy of the `site.css` file from the **ui.frontend** module. Now that it is in **ui.apps** module it can be deployed to AEM.

    ![ui.apps clientlib-site](assets/client-side-libraries/ui-apps-clientlib-site-css.png)

    >[!NOTE]
    >
    > Since **clientlib-site** is compiled during build time, using either **npm**, or **maven**, it can be safely ignored from source control in the **ui.apps** module. Inspect the `.gitignore` file beneath **ui.apps**.

1. Open the LA Skatepark article in AEM at: [http://localhost:4502/editor.html/content/wknd/us/en/magazine/guide-la-skateparks.html](http://localhost:4502/editor.html/content/wknd/us/en/magazine/guide-la-skateparks.html).

    ![Updated Base Styles for the Article](assets/client-side-libraries/updated-base-styles.png)

    You should now see the updated styles for the article. You may need to do a hard refresh to clear any CSS files cached by the browser.

    It's starting to look a lot closer to the mockups!

    >[!NOTE]
    >
    > The steps performed above to build and deploy the ui.frontend code to AEM is executed automatically when a Maven build is triggered from the root of the project `mvn clean install -PautoInstallSinglePackage`.

## Make a style change

Next, make a small change in the `ui.frontend` module to see the `npm run watch` automatically deploy the styles to the local AEM instance.

1. From, the `ui.frontend` module open the file: `ui.frontend/src/main/webpack/site/_variables.scss`.
1. Update the `$brand-primary` color variable:

    ```scsss
    //== variables.css

    //== Brand Colors
    $brand-primary:          $pink;
    ```

    Save the changes.

1. Return to the browser and refresh the AEM page to see the updates:

    ![Client Side Libraries](assets/client-side-libraries/style-update-brand-primary.png)

1. Revert the change to the `$brand-primary` color and stop the webpack build using the command `CTRL+C`.

>[!CAUTION]
>
> The use of the **ui.frontend** module may not be necessary for all projects. The **ui.frontend** module adds additional complexity and if there is not a need/desire to use some of these advanced front-end tools (Sass, webpack, npm...) it may not be needed.

## Page and Template Inclusion {#page-inclusion}

Next, let's review how the clientlibs are referenced in the AEM Page. A common best practice in web development is to include CSS in the HTML Header `<head>` and JavaScript right before closing `</body>` tag.

1. Browse to the Article Page template at [http://localhost:4502/editor.html/conf/wknd/settings/wcm/templates/article-page/structure.html](http://localhost:4502/editor.html/conf/wknd/settings/wcm/templates/article-page/structure.html)

1. Click the **Page Information** icon and in the menu select **Page Policy** to open the **Page Policy** dialog.

    ![Article Page Template Menu Page Policy](assets/client-side-libraries/template-page-policy.png)

    *Page Information &gt; Page Policy*

1. Notice that the categories for `wknd.dependencies` and `wknd.site` are listed here. By default clientlibs configured via the Page Policy are split to include the CSS in the page head and the JavaScript at the body end. You can explicitly list the clientlib JavaScript be loaded in the Page head. This is the case for `wknd.dependencies`.

    ![Article Page Template Menu Page Policy](assets/client-side-libraries/template-page-policy-clientlibs.png)

    >[!NOTE]
    >
    > It is also possible to reference the `wknd.site` or `wknd.dependencies` from the page component directly, using the `customheaderlibs.html` or `customfooterlibs.html` script. Using the Template gives flexibility in that you can pick and choose which clientlibs are used per template. For example, if you have a heavy JavaScript library that is only going to be used on a select template.

1. Navigate to the **LA Skateparks** page created using the **Article Page Template**: [http://localhost:4502/editor.html/content/wknd/us/en/magazine/guide-la-skateparks.html](http://localhost:4502/editor.html/content/wknd/us/en/magazine/guide-la-skateparks.html).

1. Click the **Page Information** icon and in the menu select **View As Published** to open the article page outside of the AEM Editor.

    ![View as Published](assets/client-side-libraries/view-as-published-article-page.png)

1. View the Page source of [http://localhost:4502/content/wknd/us/en/magazine/guide-la-skateparks.html?wcmmode=disabled](http://localhost:4502/content/wknd/us/en/magazine/guide-la-skateparks.html?wcmmode=disabled) and you should be able to see the following clientlib references in the `<head>`:

    ```html
    <head>
    ...
    <script src="/etc.clientlibs/wknd/clientlibs/clientlib-dependencies.lc-d41d8cd98f00b204e9800998ecf8427e-lc.min.js"></script>
    <link rel="stylesheet" href="/etc.clientlibs/wknd/clientlibs/clientlib-dependencies.lc-d41d8cd98f00b204e9800998ecf8427e-lc.min.css" type="text/css">
    <link rel="stylesheet" href="/etc.clientlibs/wknd/clientlibs/clientlib-site.lc-78fb9cea4c3a2cc17edce2c2b32631e2-lc.min.css" type="text/css">
    ...
    </head>
    ```

    Notice that the clientlibs are using the proxy `/etc.clientlibs` endpoint. You should also see that the following clientlib includes at the bottom of the page:

    ```html
    ...
    <script src="/etc.clientlibs/wknd/clientlibs/clientlib-site.lc-7157cf8cb32ed66d50e4e49cdc50780a-lc.min.js"></script>
    <script src="/etc.clientlibs/wknd/clientlibs/clientlib-base.lc-53e6f96eb92561a1bdcc1cb196e9d9ca-lc.min.js"></script>
    ...
    </body>
    ```

    >[!NOTE]
    >
    > For AEM 6.5/6.4 the client-side libraries are not automatically minified. See the documentation on the [HTML Library Manager to enable minification (recommended)](https://experienceleague.adobe.com/docs/experience-manager-65/developing/introduction/clientlibs.html?lang=en#using-preprocessors).

    >[!WARNING]
    >
    >It is critical on the publish side that the client libraries are **not** served from **/apps** as this path should be restricted for security reasons using the [Dispatcher filter section](https://experienceleague.adobe.com/docs/experience-manager-dispatcher/using/configuring/dispatcher-configuration.html#example-filter-section). The [allowProxy property](https://experienceleague.adobe.com/docs/experience-manager-65/developing/introduction/clientlibs.html#locating-a-client-library-folder-and-using-the-proxy-client-libraries-servlet) of the client library ensures the CSS and JS are served from **/etc.clientlibs**.

### Next Steps {#next-steps}

Learn how to implement individual styles and reuse Core Components using Experience Manager's Style System. [Developing with the Style System](style-system.md) covers using the Style System to extend Core Components with brand-specific CSS and advanced policy configurations of the Template Editor.

View the finished code on [GitHub](https://github.com/adobe/aem-guides-wknd) or review and deploy the code locally at on the Git branch `tutorial/client-side-libraries-solution`.

1. Clone the [github.com/adobe/aem-wknd-guides](https://github.com/adobe/aem-guides-wknd) repository.
1. Check out the `tutorial/client-side-libraries-solution` branch.

## Additional Tools and Resources {#additional-resources}

### Webpack DevServer - Static Markup {#webpack-dev-static}

In the previous couple of exercises several Sass files in the **ui.frontend** module were updated and through a build process, ultimately see that these changes reflected in AEM. Next let's look at a technique that uses a [webpack-dev-server](https://webpack.js.org/configuration/dev-server/) to rapidly develop the front-end styles against **static** HTML.

This technique is handy if most the styles and front-end code is performed by a dedicated Front-End developer who may not have easy access to an AEM environment. This technique also allows the FED to make modifications directly to the HTML, which can then be handed off to an AEM developer to implement as components.

1. Copy the page source of the LA skatepark article page at [http://localhost:4502/content/wknd/us/en/magazine/guide-la-skateparks.html?wcmmode=disabled](http://localhost:4502/content/wknd/us/en/magazine/guide-la-skateparks.html?wcmmode=disabled).
1. Reopen your IDE. Paste the copied markup from AEM into the `index.html` in the **ui.frontend** module beneath `src/main/webpack/static`.
1. Edit the copied markup and remove any references to **clientlib-site** and **clientlib-dependencies**:

    ```html
    <!-- remove -->
    <script type="text/javascript" src="/etc.clientlibs/wknd/clientlibs/clientlib-dependencies.js"></script>
    <link rel="stylesheet" href="/etc.clientlibs/wknd/clientlibs/clientlib-dependencies.css" type="text/css">
    <link rel="stylesheet" href="/etc.clientlibs/wknd/clientlibs/clientlib-site.css" type="text/css">
    ...
    <script type="text/javascript" src="/etc.clientlibs/wknd/clientlibs/clientlib-site.js"></script>
    ```

    Remove these references because the webpack dev server generates these artifacts automatically.

1. Start the webpack dev server from a new terminal by running the following command from within the **ui.frontend** module:

    ```shell
    $ cd ~/code/aem-guides-wknd/ui.frontend/
    $ npm start

    > aem-maven-archetype@1.0.0 start code/aem-guides-wknd/ui.frontend
    > webpack-dev-server --open --config ./webpack.dev.js
    ```

1. This should open a new browser window at [http://localhost:8080/](http://localhost:8080/) with static markup.

1. Edit the file `src/main/webpack/site/_variables.scss` file. Replace the `$text-color` rule with the following:

    ```diff
    - $text-color:              $black;
    + $text-color:              $pink;
    ```

    Save the changes. 

1. You should automatically see the changes automatically reflected in the browser on [http://localhost:8080](http://localhost:8080).

    ![Local webpack dev server changes](assets/client-side-libraries/local-webpack-dev-server.png)

1. Review the `/aem-guides-wknd.ui.frontend/webpack.dev.js` file. This contains the webpack configuration used to start the webpack-dev-server. It proxies the paths `/content` and `/etc.clientlibs` from a locally running instance of AEM. This is how the images, and other clientlibs (not managed by the **ui.frontend** code) are made available.

    >[!CAUTION]
    >
    > The image src of the static markup points to a live image component on a local AEM instance. Images appear broken if the path to the image changes, if AEM is not started, or if the browser has not logged into the local AEM instance. If handing off to an external resource, it's also possible to replace the images with static references.

1. You can **stop** the webpack server from the command line by typing `CTRL+C`.

### aemfed {#develop-aemfed}

**[aemfed](https://aemfed.io/)** is an open-source, command-line  tool that can be used to speed up front-end development. It is powered by [aemsync](https://www.npmjs.com/package/aemsync), [Browsersync](https://browsersync.io/), and [Sling Log Tracer](https://sling.apache.org/documentation/bundles/log-tracers.html).

At a high level, the `aemfed`is designed to listen to file changes within the **ui.apps** module and automatically sync them directly to a running AEM instance. Based on the changes, a local browser automatically refreshes, thus speeding up front-end development. It is also built to work with Sling Log tracer to automatically display any server-side errors directly in the terminal.

If you are doing much work within the **ui.apps** module, modifying HTL scripts, and creating custom components, **aemfed** can be a powerful tool to use. [Full documentation can be found here](https://github.com/abmaonline/aemfed).

### Debugging Client-side Libraries {#debugging-clientlibs}

Using different methods of **categories** and **embeds** to include multiple client libraries it can be cumbersome to troubleshoot. AEM exposes several tools to help with this. One of the most important tools is **Rebuild Client Libraries** which forces AEM to recompile any LESS files and generate the CSS.

* [**Dump Libs**](http://localhost:4502/libs/granite/ui/content/dumplibs.html) - Lists the client libraries registered in the AEM instance. `<host>/libs/granite/ui/content/dumplibs.html`

* [**Test Output**](http://localhost:4502/libs/granite/ui/content/dumplibs.test.html) - allows a user to see the expected HTML output of clientlib includes based on category. `<host>/libs/granite/ui/content/dumplibs.test.html`

* [**Libraries Dependencies validation**](http://localhost:4502/libs/granite/ui/content/dumplibs.validate.html) - highlights any dependencies or embedded categories that cannot be found. `<host>/libs/granite/ui/content/dumplibs.validate.html`

* [**Rebuild Client Libraries**](http://localhost:4502/libs/granite/ui/content/dumplibs.rebuild.html) - allows a user to force AEM to rebuild the client libraries or invalidate the cache of client libraries. This tool is effective when developing with LESS as this can force AEM to recompile the generated CSS. In general, it is more effective to Invalidate Caches and then perform a page refresh versus rebuilding the libraries. `<host>/libs/granite/ui/content/dumplibs.rebuild.html`

![rebuild client library](assets/client-side-libraries/rebuild-clientlibs.png)
